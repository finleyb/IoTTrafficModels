#CONFIG CONSTANTS
lib_folder = "./"

# FIRST RUN
# install.packages("ClickClust", lib = lib_folder)

#AFTER FIRST RUN
.libPaths(lib_folder)
library(ClickClust)
set.seed(123)

#INPUT VARIABLES
n.seq <- 10 # desired number of sequences
min_seq_length <- 5
max_seq_length <- 300

#MODEL CONSTANTS
p <- 7 
K <- 3 
mix.prop <- c(0.6657409, 0.0438965, 0.2903626) 

#SIMULATOR CODE FROM
TP <- array(rep(NA, p * p * K), c(p, p, K)) 

TP[, , 1] <- matrix(c(0.46801957,0.3324527,0.05958952,0.01,0.02676897,0.05976122,0.04340802, 
                      + 0.28039285,0.32949238,0.20868036,0.01056922,0.04416381,0.02567106,0.10103031, 
                      + 0.01984175,0.02999823,0.25977021,0.19631271,0.16013021,0.18580045,0.14814643, 
                      + 0.01091715,0.01404095,0.07624368,0.01,0.58746807,0.21101942,0.09031073, 
                      + 0.012916,0.01054402,0.0717031,0.66100944,0.01,0.14964172,0.08418573, 
                      + 0.01173023,0.01187606,0.12048809,0.43379171,0.30343778,0.01,0.10867613, 
                      + 0.01000451,0.01983148,0.18935583,0.28458613,0.28626559,0.19995646,0.01),byrow = TRUE, ncol = p)

TP[, , 2] <- matrix(c(0.3096679,0.2693852,0.1739579,0.07774555,0.06165914,0.06196502,0.04561923,
                      + 0.2618293,0.256649,0.2080068,0.06866182,0.07852041,0.06798394,0.05834871,
                      + 0.2446527,0.3324785,0.1399842,0.09029756,0.06698229,0.06562478,0.05997998,
                      + 0.2160828,0.3153345,0.1701953,0.01,0.10474085,0.11476246,0.06888417,
                      + 0.2350418,0.3084895,0.1936757,0.12876843,0.01,0.03804043,0.08598414, 
                      + 0.2712504,0.2924704,0.1783668,0.11564497,0.07265527,0.01,0.05961215,
                      + 0.2534759,0.3028652,0.1558536,0.07026713,0.14781026,0.05972796,0.01),byrow = TRUE, ncol = p) 

TP[, , 3] <- matrix(c(0.11347233,0.3274411,0.2622922,0.01,0.07565374,0.13736958,0.07377106,
                      + 0.01059867,0.3227964,0.2428862,0.1411327,0.10793207,0.09154039,0.08311355,
                      + 0.01,0.2330179,0.2347657,0.1610487,0.14772879,0.10689827,0.10654061,
                      + 0.01216748,0.1892184,0.3229051,0.01,0.17459308,0.16487944,0.12623644, 
                      + 0.02197275,0.2036013,0.2733512,0.2178729,0.01,0.14305816,0.13014371,
                      + 0.01632917,0.1975806,0.2678153,0.2194571,0.1781071,0.01,0.11071069,
                      + 0.01254842,0.2056108,0.2944429,0.1757499,0.18167369,0.11997431,0.01),byrow = TRUE, ncol = p) 

A <- click.sim(n = n.seq, int = c(min_seq_length, max_seq_length), alpha = mix.prop, gamma = TP)

#EXPORT TO FILE
lapply("Simulated sequences follow:", write, "simulated_sequences.txt", append=FALSE, ncolumns=max_seq_length)
for (B in A[1]){
    lapply(B, write, "simulated_sequences.txt", append=TRUE, ncolumns=max_seq_length)
}
lapply("Assignment of sequences to components:", write, "simulated_sequences.txt", append=TRUE, ncolumns=max_seq_length)
lapply(A[2], write, "simulated_sequences.txt", append=TRUE, ncolumns=max_seq_length)










